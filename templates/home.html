{% extends 'base.html' %} {% block body %}
<nav class="navbar navbar-dark bg-dark">
  <div class="container-fluid">
    <a class="navbar-brand">Navbar</a>
    <form id="searchForm" class="d-flex">
      <input
        class="form-control me-2"
        type="search"
        placeholder="Search"
        id="find"
        aria-label="Search"
      />
      <button class="btn btn-outline-success" type="submit">Search</button>
    </form>
  </div>
</nav>

<div class="container">
  <div id="results" class="mt-5 row results-bookmarks"></div>
</div>

<script>
  var formEl = document.getElementById("searchForm");

  formEl.addEventListener("submit", function (event) {
    var searchKey = document.getElementById("find");
    console.log(searchKey.value);
    // 1. Setup the request
    // ================================
    // 1.1 Headers
    var headers = new Headers();
    // Tell the server we want JSON back
    headers.set("Accept", "application/json");
    // ================================
    var url = "http://localhost:8000/api/bookmarks/" + searchKey.value;
    var fetchOptions = {
      method: "GET",
      headers,
    };

    var responsePromise = fetch(url, fetchOptions);
    responsePromise
      // 3.1 Convert the response into JSON-JS object.
      .then(function (response) {
        return response.json();
      })
      // 3.2 Do something with the JSON data
      .then(function (jsonData) {
        var bookmarks = "";
        jsonData.forEach((el) => {
          bookmarks += `<div class="card mr-2 col-md-2">
        <div class="card-body">
        <h5 class="card-title">${el.title}</h5>
        <a href="${el.url}" class="card-link">Visit</a>
        </div>
        </div>`;
        });
        document.getElementById("results").innerHTML = bookmarks;
      });

    event.preventDefault();
  });
</script>

{% endblock body %}
